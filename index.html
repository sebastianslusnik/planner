<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="theme-color" content="#0b0d10">
<title>Világbajnok Kick-box Edző | Mosonmagyaróvár</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#0b0d10;--panel:#10141b;--line:#1a2231;--muted:#95a1b6;--text:#e8edf7;--accent:#e11d2e;--accent2:#d4af37;--ok:#20c05a}
*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;line-height:1.5}
a{color:inherit;text-decoration:none}
img{max-width:100%;display:block}
.container{width:100%;max-width:1040px;margin:0 auto;padding:0 16px}
.header{position:sticky;top:0;z-index:50;background:#0b0d10cc;backdrop-filter:blur(6px);border-bottom:1px solid var(--line)}
.nav{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
.brand{display:flex;align-items:center;gap:10px}
.logo{width:34px;height:34px;border-radius:10px;background:#121722;display:grid;place-items:center;border:1px solid var(--line)}
.logo span{font-family:Oswald,sans-serif;color:var(--accent2);font-weight:700}
.brand .name{font-family:Oswald,sans-serif;letter-spacing:.6px}
.navlinks{display:none;gap:14px}
.burger{display:inline-flex;background:#121722;border:1px solid var(--line);padding:8px;border-radius:10px}
#mobileMenu{display:none;padding:8px 0;border-top:1px solid var(--line)}
#mobileMenu a{display:block;padding:10px;border-radius:8px}
.ann-strip{display:none;border-top:1px solid var(--line);border-bottom:1px solid var(--line);background:#0f131a}
.ann-row{display:flex;gap:8px;overflow:auto;padding:8px 16px}
.ann{display:inline-flex;gap:8px;align-items:center;padding:8px 10px;border:1px solid var(--line);border-radius:999px;background:#0f141d;color:#dfe5f5}
.ann.warn{border-color:#3a2f12;background:#14120c;color:#ffdb99}
.ann.danger{border-color:#401a1a;background:#170e0e;color:#ffc9c9}
.hero{padding:18px 0;border-bottom:1px solid var(--line)}
.section{padding:28px 0;border-bottom:1px solid var(--line)}
.h1{font-family:Oswald,sans-serif;font-size:28px;margin:8px 0 0}
.lead{color:var(--muted);margin:8px 0 0}
.btn{display:inline-flex;align-items:center;justify-content:center;border:none;background:var(--accent);color:#fff;padding:12px 14px;border-radius:10px;font-weight:700;cursor:pointer}
.btn.alt{background:#141a24;border:1px solid var(--line);color:#cfd7ea}
.btn.block{width:100%}
.grid{display:grid;grid-template-columns:1fr;gap:12px}
.panel{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:14px}
.calendar-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.tabs{display:flex;gap:6px}
.tab{padding:6px 10px;border-radius:10px;border:1px solid var(--line);background:#0e131b;color:#dfe5f7;cursor:pointer}
.tab.active{background:var(--accent);border-color:transparent}
.session{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;border:1px solid var(--line);background:#0f141c;border-radius:12px;padding:10px}
.s-left{display:flex;gap:10px}
.color{width:12px;height:12px;border-radius:4px;margin-top:4px}
.s-name{font-weight:700}
.s-sub{color:var(--muted);font-size:12px}
.badge{display:inline-block;padding:3px 8px;border-radius:999px;border:1px solid var(--line);background:#141a24;color:#dfe6fa;font-size:12px}
.price-grid{display:grid;grid-template-columns:1fr;gap:12px}
.price-card{background:var(--panel);border:1px solid var(--line);border-radius:14px;padding:16px}
.price{font-family:Oswald,sans-serif;font-size:26px}
.gallery-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:6px}
.gallery-grid img{height:90px;object-fit:cover;border-radius:10px}
.news-grid{display:grid;grid-template-columns:1fr;gap:12px}
.news-card{display:flex;gap:10px;border:1px solid var(--line);background:#0f141c;border-radius:12px;overflow:hidden}
.news-card img{width:120px;height:120px;object-fit:cover}
.input{display:grid;gap:6px}
.input input,.input select,.input textarea{width:100%;padding:12px;background:#0b0f16;border:1px solid var(--line);border-radius:10px;color:#f0f5ff}
.form .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.modal{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;z-index:100;background:rgba(0,0,0,.4)}
.modal.active{display:flex}
.modal .sheet{background:#0d1118;border-top-left-radius:16px;border-top-right-radius:16px;width:100%;max-width:560px;border:1px solid var(--line);padding:16px}
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:16px;background:#0e131b;border:1px solid var(--line);color:#e9efff;padding:10px 14px;border-radius:10px;display:none;z-index:120}
.footer{padding:24px 0;border-top:1px solid var(--line);color:#aeb7ca}
@media(min-width:740px){
.navlinks{display:flex}
.burger{display:none}
.h1{font-size:36px}
.price-grid{grid-template-columns:repeat(4,1fr)}
.gallery-grid{grid-template-columns:repeat(6,1fr)}
.news-grid{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>
<body>
<header class="header">
<div class="container nav">
<div class="brand">
<div class="logo"><span>KB</span></div>
<div class="name">Kick-box Edző</div>
</div>
<nav class="navlinks">
<a href="#naptar">Naptár</a>
<a href="#arak">Árak</a>
<a href="#hirek">Hírek</a>
<a href="#kickbox">Kick-box</a>
<a href="#galeria">Galéria</a>
<a href="#rolam">Rólam</a>
<a href="#kapcsolat">Kapcsolat</a>
</nav>
<button class="burger" id="burger" aria-label="Menü"><svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M4 6h16M4 12h16M4 18h16" stroke="#cfd7ea" stroke-width="2" stroke-linecap="round"/></svg></button>
</div>
<div id="mobileMenu" class="container">
<a href="#naptar">Naptár</a>
<a href="#arak">Árak</a>
<a href="#hirek">Hírek</a>
<a href="#kickbox">Kick-box</a>
<a href="#galeria">Galéria</a>
<a href="#rolam">Rólam</a>
<a href="#kapcsolat">Kapcsolat</a>
</div>
<div id="annBar" class="ann-strip">
<div class="ann-row container" id="annStrip"></div>
</div>
</header>

<section class="hero">
<div class="container">
<div class="h1">Edzésnaptár és foglalás</div>
<p class="lead">Válassz időpontot, foglalj helyet. Limitált létszámú edzések Mosonmagyaróváron.</p>
</div>
</section>

<section id="naptar" class="section">
<div class="container">
<div class="panel">
<div class="calendar-head">
<div style="display:flex;align-items:center;gap:8px">
<button class="tab" id="prevWeek" aria-label="Előző hét">‹</button>
<strong id="weekRange"></strong>
<button class="tab" id="nextWeek" aria-label="Következő hét">›</button>
</div>
<div class="tabs">
<button class="tab active" id="tabList">Lista</button>
<button class="tab" id="tabWeek">Heti</button>
</div>
</div>
<div id="sessionsList" class="grid"></div>
<div id="sessionsWeek" class="grid" style="display:none"></div>
</div>
</div>
</section>

<section id="arak" class="section">
<div class="container">
<div class="h1">Árak és csomagok</div>
<p class="lead">Alkalmi belépő, bérlet, korlátlan havibérlet és személyi edzés.</p>
<div class="price-grid" style="margin-top:12px">
<div class="price-card">
<div class="price">3 500 Ft</div>
<div>Alkalmi belépő</div>
<ul>
<li>1 edzés</li>
<li>Kezdőtől haladóig</li>
</ul>
<button class="btn" onclick="scrollToCalendar()">Foglalok</button>
</div>
<div class="price-card">
<div class="price">28 000 Ft</div>
<div>10 alkalmas bérlet</div>
<ul>
<li>60 napig érvényes</li>
<li>Kedvezményes egységár</li>
</ul>
<button class="btn" onclick="scrollToCalendar()">Foglalok</button>
</div>
<div class="price-card">
<div class="price">24 900 Ft</div>
<div>Havi korlátlan</div>
<ul>
<li>Korlátlan csoportos</li>
<li>Havi megújulás</li>
</ul>
<button class="btn" onclick="scrollToCalendar()">Foglalok</button>
</div>
<div class="price-card">
<div class="price">8 900 Ft</div>
<div>Személyi edzés</div>
<ul>
<li>1x60 perc</li>
<li>Egyéni célok</li>
</ul>
<a class="btn" href="#kapcsolat">Kapcsolat</a>
</div>
</div>
</div>
</section>

<section id="hirek" class="section">
<div class="container">
<div class="h1">Hírek</div>
<p class="lead">Friss bejelentések és beszámolók.</p>
<div class="news-grid" id="newsGrid" style="margin-top:12px"></div>
</div>
</section>

<section id="kickbox" class="section">
<div class="container">
<div class="h1">Mi az a kick-box?</div>
<div class="grid" style="margin-top:12px">
<div class="panel"><strong>Dinamikus küzdősport</strong><p>A kick-box ütések és rúgások kombinációjára épül. Fejleszti az erőt, állóképességet és reflexeket.</p></div>
<div class="panel"><strong>Technika és fizikum</strong><p>Kombinációk, lábmunka, zsákmunka, erősítő és mobilitás. Fokozatos terhelés.</p></div>
<div class="panel"><strong>Biztonságos fejlődés</strong><p>Irányított sparring, védőfelszerelés és tiszta szabályok a tanulási ív mentén.</p></div>
</div>
</div>
</section>

<section id="galeria" class="section">
<div class="container">
<div class="h1">Galéria</div>
<div class="gallery-grid" id="gallery" style="margin-top:12px">
<button><img src="https://images.unsplash.com/photo-1607962837359-915385c5a8f3?q=80&w=600&auto=format&fit=crop" alt=""></button>
<button><img src="https://images.unsplash.com/photo-1521805103424-d8f8430e8930?q=80&w=600&auto=format&fit=crop" alt=""></button>
<button><img src="https://images.unsplash.com/photo-1605296867304-46d5465a13f1?q=80&w=600&auto=format&fit=crop" alt=""></button>
<button><img src="https://images.unsplash.com/photo-1534158914592-062992fbe900?q=80&w=600&auto=format&fit=crop" alt=""></button>
<button><img src="https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=600&auto=format&fit=crop" alt=""></button>
<button><img src="https://images.unsplash.com/photo-1597466765990-64ad1c35dafc?q=80&w=600&auto=format&fit=crop" alt=""></button>
</div>
</div>
</section>

<section id="rolam" class="section">
<div class="container">
<div class="h1">Rólam</div>
<div class="panel" style="display:flex;gap:12px;align-items:center;margin-top:12px">
<img src="https://images.unsplash.com/photo-1549057446-9f5c6ac91a04?q=80&w=600&auto=format&fit=crop" alt="Edző" style="width:84px;height:84px;border-radius:10px;object-fit:cover;border:1px solid var(--line)">
<div>
<div style="font-weight:700">Világbajnok Kick-box Edző</div>
<div class="s-sub">Nemzetközi verseny- és edzői tapasztalat. Kezdőtől haladóig, strukturált rendszer szerint.</div>
</div>
</div>
</div>
</section>

<section id="kapcsolat" class="section">
<div class="container">
<div class="h1">Kapcsolat</div>
<div class="grid" style="margin-top:12px">
<div class="panel">
<p><strong>Helyszín</strong><br>Mosonmagyaróvár, Magyarország</p>
<p><strong>E-mail</strong><br><a href="mailto:info@kickbox-movar.hu">info@kickbox-movar.hu</a></p>
<p><strong>Telefon</strong><br><a href="tel:+36301234567">+36 30 123 4567</a></p>
<p><a class="btn alt" href="https://maps.google.com/?q=Mosonmagyar%C3%B3v%C3%A1r" target="_blank" rel="noopener">Útvonalterv</a></p>
</div>
<div class="panel" style="padding:0;overflow:hidden">
<iframe title="Térkép - Mosonmagyaróvár" src="https://www.google.com/maps?q=Mosonmagyar%C3%B3v%C3%A1r,Hungary&output=embed" width="100%" height="260" frameborder="0" style="border:0"></iframe>
</div>
</div>
</div>
</section>

<footer class="footer">
<div class="container" style="display:flex;flex-direction:column;gap:6px">
<div>© <span id="year"></span> Világbajnok Kick-box Edző • Mosonmagyaróvár</div>
<div>Közösség: <a href="#">Instagram</a> • <a href="#">Facebook</a></div>
<div><a href="admin.html">Admin</a></div>
</div>
</footer>

<div class="modal" id="imgModal">
<div class="sheet">
<div style="display:flex;justify-content:flex-end;margin-bottom:8px">
<button class="btn alt" id="imgClose">Bezárás</button>
</div>
<img id="imgPreview" alt="" style="width:100%;height:auto;border-radius:10px">
</div>
</div>

<div class="modal" id="bookModal">
<div class="sheet">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
<div style="font-weight:700">Foglalás</div>
<button class="btn alt" id="bookClose">Bezárás</button>
</div>
<form class="form" id="bookForm">
<div class="input"><label>Választott edzés</label><input id="bfTraining" type="text" readonly></div>
<div class="row">
<div class="input"><label>Dátum</label><input id="bfDate" type="text" readonly></div>
<div class="input"><label>Időpont</label><input id="bfTime" type="text" readonly></div>
</div>
<div class="row">
<div class="input"><label>Teljes név</label><input id="bfName" type="text" required></div>
<div class="input"><label>E-mail</label><input id="bfEmail" type="email" required></div>
</div>
<div class="row">
<div class="input"><label>Telefon</label><input id="bfPhone" type="tel" required></div>
<div class="input"><label>Megjegyzés</label><input id="bfNote" type="text" placeholder="Opcionális"></div>
</div>
<input type="hidden" id="bfTrainingId">
<input type="hidden" id="bfCapacity">
<button class="btn block" type="submit">Foglalás megerősítése</button>
<small class="s-sub">A foglalással elfogadod a részvételi feltételeket.</small>
</form>
</div>
</div>

<div class="toast" id="toast"></div>

<script>
const JSONBIN_KEY="$2a$10$9sO/ja29sMebpWNvsWmp5.dJ6lv7CPeLBMRFaA/cAEwz42ii6qlCS";
const BINS={ann:"68b5536243b1c97be932d1ed",res:"68b5535343b1c97be932d1e1",news:"68b5531fd0ea881f406dbd52",cal:"68b55123d0ea881f406dbb52"};
const huDaysFull=["Vasárnap","Hétfő","Kedd","Szerda","Csütörtök","Péntek","Szombat"];
const huMonths=["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"];
const today=new Date();
let weekStart=startOfWeek(today);
let state={calendar:{trainingTypes:[],recurring:[]},reservations:[],announcements:[],news:[]};
function startOfWeek(d){const x=new Date(d);const wd=(x.getDay()+6)%7;x.setDate(x.getDate()-wd);x.setHours(0,0,0,0);return x}
function endOfWeek(d){const x=new Date(d);x.setDate(x.getDate()+6);x.setHours(23,59,59,999);return x}
function addDays(d,n){const x=new Date(d);x.setDate(x.getDate()+n);x.setHours(0,0,0,0);return x}
function fmtDateISO(d){const y=d.getFullYear();const m=String(d.getMonth()+1).padStart(2,"0");const da=String(d.getDate()).padStart(2,"0");return y+"-"+m+"-"+da}
function fmtHuman(d){return d.getDate()+". "+huMonths[d.getMonth()]+" "+d.getFullYear()+"."}
function uid(){if(crypto&&crypto.randomUUID){return crypto.randomUUID()}return "id-"+Date.now()+"-"+Math.floor(Math.random()*1e6)}
async function getBin(id){try{const r=await fetch("https://api.jsonbin.io/v3/b/"+id+"/latest",{headers:{"X-Master-Key":JSONBIN_KEY}});if(!r.ok)throw new Error("get "+id);const j=await r.json();return j.record}catch(e){return null}}
async function putBin(id,data){const r=await fetch("https://api.jsonbin.io/v3/b/"+id,{method:"PUT",headers:{"Content-Type":"application/json","X-Master-Key":JSONBIN_KEY},body:JSON.stringify(data)});if(!r.ok)throw new Error("put "+id);return true}
function toast(msg){const t=document.getElementById("toast");t.textContent=msg;t.style.display="block";setTimeout(()=>{t.style.display="none"},2200)}
function validStr(s){return typeof s==="string"&&s.trim()!==""&&s.trim().toLowerCase()!=="undefined"&&s.trim().toLowerCase()!=="null"}
function sampleCalendar(){return {trainingTypes:[{id:"t1",name:"Alap technika",description:"Kezdőknek technikai alapok",level:"Kezdő",color:"#4f46e5",capacity:14,duration:60,location:"Dojo A"},{id:"t2",name:"Erő-állóképesség",description:"Kondicionáló fókusz",level:"Nyílt",color:"#22c55e",capacity:16,duration:60,location:"Dojo B"},{id:"t3",name:"Haladó kombinációk",description:"Kombinációk és sparring",level:"Haladó",color:"#e11d2e",capacity:12,duration:75,location:"Dojo A"}],recurring:[{id:"r1",trainingTypeId:"t1",weekday:1,time:"18:00",location:"Dojo A"},{id:"r2",trainingTypeId:"t2",weekday:3,time:"18:00",location:"Dojo B"},{id:"r3",trainingTypeId:"t3",weekday:5,time:"17:30",location:"Dojo A"}]}}
async function loadAll(){const [ann,cal,news,res]=await Promise.all([getBin(BINS.ann),getBin(BINS.cal),getBin(BINS.news),getBin(BINS.res)]);const anns=Array.isArray(ann)?ann:[];const newsArr=Array.isArray(news)?news:[];const resArr=Array.isArray(res)?res:[];state.announcements=anns.filter(a=>a&&validStr(a.title)&&validStr(a.content));state.calendar=(cal&&cal.trainingTypes)?cal:sampleCalendar();state.news=newsArr.filter(n=>n&&validStr(n.title)&&validStr(n.content));state.reservations=resArr.filter(r=>r&&validStr(r.name)&&validStr(r.date)&&validStr(r.time)&&validStr(r.trainingTypeId));renderAll()}
function renderAll(){renderAnnouncements();renderCalendar();renderNews();document.getElementById("year").textContent=String(new Date().getFullYear())}
function renderAnnouncements(){const wrap=document.getElementById("annStrip");const bar=document.getElementById("annBar");wrap.innerHTML="";const now=new Date();const list=state.announcements.filter(a=>a.active!==false).filter(a=>!a.expiresAt||new Date(a.expiresAt)>=now);if(list.length===0){bar.style.display="none";return}bar.style.display="block";list.forEach(a=>{const el=document.createElement("div");el.className="ann"+(a.type==="warning"?" warn":a.type==="danger"?" danger":"");el.innerHTML="<strong>"+a.title+"</strong> "+a.content;wrap.appendChild(el)})}
function sessionsBetween(from,to){const out=[];const trainingTypes=state.calendar.trainingTypes;const recurring=state.calendar.recurring;for(let i=0;i<recurring.length;i++){const r=recurring[i];let cur=new Date(from);cur.setHours(0,0,0,0);while(cur<=to){if(cur.getDay()===r.weekday){const dstr=fmtDateISO(cur);const t=findType(r.trainingTypeId);const loc=r.location||(t?t.location:"");out.push({id:"s-"+r.id+"-"+dstr,trainingTypeId:r.trainingTypeId,date:dstr,time:r.time,location:loc,capacity:r.capacity||null});cur=addDays(cur,7)}else{cur=addDays(cur,1)}}}out.sort((a,b)=>new Date(a.date+"T"+a.time)-new Date(b.date+"T"+b.time));return out}
function findType(id){return state.calendar.trainingTypes.find(t=>t.id===id)}
function occFor(s){return state.reservations.filter(x=>x.trainingTypeId===s.trainingTypeId&&x.date===s.date&&x.time===s.time).length}
function renderCalendar(){const ws=weekStart;const we=endOfWeek(ws);document.getElementById("weekRange").textContent=fmtHuman(ws)+" – "+fmtHuman(we);const list=sessionsBetween(ws,we);const listWrap=document.getElementById("sessionsList");const weekWrap=document.getElementById("sessionsWeek");listWrap.innerHTML="";weekWrap.innerHTML="";if(list.length===0){listWrap.innerHTML='<div class="panel">Nincs ütemezett edzés ezen a héten.</div>';weekWrap.innerHTML=listWrap.innerHTML;return}list.forEach(s=>{const t=findType(s.trainingTypeId);if(!t)return;const cap=s.capacity||t.capacity;const occ=occFor(s);const free=Math.max(0,cap-occ);const row=document.createElement("div");row.className="session";row.innerHTML='<div class="s-left"><div class="color" style="background:'+(t.color||"#e11d2e")+'"></div><div><div class="s-name">'+t.name+' • '+s.time+'</div><div class="s-sub">'+huDaysFull[new Date(s.date).getDay()]+' • '+s.date+' • '+(s.location||t.location)+' • '+(t.level||"")+'</div></div></div><div>'+(free>0?('<div style="text-align:right;margin-bottom:6px" class="s-sub">'+occ+'/'+cap+' foglalt</div><button class="btn" data-sid="'+s.id+'">Foglalás</button>'):'<span class="badge">Betelt</span>')+'</div>';listWrap.appendChild(row)});const days=[0,1,2,3,4,5,6].map(d=>({d,list:list.filter(s=>new Date(s.date).getDay()===d)}));days.forEach(day=>{const col=document.createElement("div");col.innerHTML='<div style="font-weight:700;margin:6px 0">'+huDaysFull[day.d]+"</div>";day.list.forEach(s=>{const t=findType(s.trainingTypeId);if(!t)return;const cap=s.capacity||t.capacity;const occ=occFor(s);const free=Math.max(0,cap-occ);const el=document.createElement("div");el.className="session";el.innerHTML='<div class="s-left"><div class="color" style="background:'+(t.color||"#e11d2e")+'"></div><div><div class="s-name">'+s.time+' • '+t.name+'</div><div class="s-sub">'+s.date+' • '+(s.location||t.location)+'</div></div></div><div>'+(free>0?'<button class="btn" data-sid="'+s.id+'">Foglalás</button>':'<span class="badge">Betelt</span>')+'</div>';col.appendChild(el)});weekWrap.appendChild(col)});document.querySelectorAll('button[data-sid]').forEach(b=>b.addEventListener('click',onBookClick))}
function onBookClick(e){const sid=e.currentTarget.getAttribute("data-sid");const sessions=sessionsBetween(addDays(weekStart,-30),addDays(endOfWeek(weekStart),60));const s=sessions.find(x=>x.id===sid);if(!s)return;const t=findType(s.trainingTypeId);document.getElementById("bfTraining").value=(t?t.name:"Edzés")+" • "+(t?t.level:"");document.getElementById("bfTrainingId").value=t?t.id:"";document.getElementById("bfDate").value=s.date;document.getElementById("bfTime").value=s.time;document.getElementById("bfCapacity").value=String(s.capacity||(t?t.capacity:0));document.getElementById("bookModal").classList.add("active")}
async function submitBooking(ev){ev.preventDefault();const trainingTypeId=document.getElementById("bfTrainingId").value;const date=document.getElementById("bfDate").value;const time=document.getElementById("bfTime").value;const name=document.getElementById("bfName").value.trim();const email=document.getElementById("bfEmail").value.trim();const phone=document.getElementById("bfPhone").value.trim();const note=document.getElementById("bfNote").value.trim();if(!trainingTypeId||!name||!email||!phone){toast("Kérjük tölts ki a kötelező mezőket.");return}const latest=await getBin(BINS.res);state.reservations=Array.isArray(latest)?latest:[];const t=findType(trainingTypeId);const cap=Number(document.getElementById("bfCapacity").value||(t?t.capacity:0));const occ=occFor({trainingTypeId:trainingTypeId,date:date,time:time});if(cap&&occ>=cap){toast("Sajnáljuk, ez az időpont betelt.");return}const rec={id:uid(),trainingTypeId:trainingTypeId,date:date,time:time,name:name,email:email,phone:phone,note:note,createdAt:new Date().toISOString()};const newArr=[].concat(state.reservations,[rec]);await putBin(BINS.res,newArr);state.reservations=newArr;toast("Foglalás rögzítve.");document.getElementById("bookModal").classList.remove("active");renderCalendar()}
function renderNews(){const grid=document.getElementById("newsGrid");grid.innerHTML="";if(state.news.length===0){grid.innerHTML='<div class="panel">Még nincs közzétett hír.</div>';return}state.news.sort((a,b)=>new Date(b.date)-new Date(a.date));state.news.forEach(n=>{const img=n.image||"https://images.unsplash.com/photo-1517438322307-e67111335449?q=80&w=600&auto=format&fit=crop";const card=document.createElement("div");card.className="news-card";card.innerHTML='<img src="'+img+'" alt=""><div style="padding:10px"><div style="font-weight:700;margin-bottom:6px">'+n.title+'</div><div class="s-sub" style="margin-bottom:8px">'+new Date(n.date||Date.now()).toLocaleDateString("hu-HU")+'</div><div>'+n.content+'</div></div>';grid.appendChild(card)})}
function scrollToCalendar(){document.querySelector("#naptar").scrollIntoView({behavior:"smooth"})}
document.getElementById("prevWeek").addEventListener("click",()=>{weekStart=addDays(weekStart,-7);renderCalendar()});
document.getElementById("nextWeek").addEventListener("click",()=>{weekStart=addDays(weekStart,7);renderCalendar()});
document.getElementById("tabList").addEventListener("click",()=>{document.getElementById("tabList").classList.add("active");document.getElementById("tabWeek").classList.remove("active");document.getElementById("sessionsList").style.display="grid";document.getElementById("sessionsWeek").style.display="none"});
document.getElementById("tabWeek").addEventListener("click",()=>{document.getElementById("tabWeek").classList.add("active");document.getElementById("tabList").classList.remove("active");document.getElementById("sessionsList").style.display="none";document.getElementById("sessionsWeek").style.display="grid"});
document.getElementById("bookClose").addEventListener("click",()=>document.getElementById("bookModal").classList.remove("active"));
document.getElementById("imgClose").addEventListener("click",()=>document.getElementById("imgModal").classList.remove("active"));
document.getElementById("bookForm").addEventListener("submit",submitBooking);
document.getElementById("burger").addEventListener("click",()=>{const m=document.getElementById("mobileMenu");m.style.display=m.style.display==="block"?"none":"block"});
document.querySelectorAll("#mobileMenu a").forEach(a=>a.addEventListener("click",()=>{document.getElementById("mobileMenu").style.display="none"}));
document.getElementById("gallery").addEventListener("click",e=>{const img=e.target.closest("img");if(!img)return;document.getElementById("imgPreview").src=img.src;document.getElementById("imgModal").classList.add("active")});
loadAll();
</script>
</body>
</html>
